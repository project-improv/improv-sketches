# settings:
  # use_watcher: [Acquirer, Processor, Analysis, Visual]

actors:
  Acquirer:
    package: actors.acquire
    class: AudioAcquirer
    n_segs: 43 # for 120 ms segments (weird, Fig 6 = 2 min data x 60 s x 1000 ms = 120000 ms = 1000 segments)
    folder: data/birdname_130519_103325.4/segments_120 # exclude data/blu285/v1/original_data/DIR/birdname_130519_103325.4.wav for embedding new, fit UMAP on 100,000 120 ms (or 60, 120, 180, 240...test min...20 ms - Fig 6 supplement 1 plots)
    time_opt: True
    timing:
      - acq_total_times
      - acq_timestamps 
      - get_wav_time
      - put_wav_time 
      - put_out_time
    out_path: output_105clip_120ms_sl/timing

  Processor:
    package: actors.processor
    class: AudioProcessor
    n_segs: 105 # for 120 ms segments (weird, Fig 6 = 2 min data x 60 s x 1000 ms = 120000 ms = 1000 segments)
    model_path: models/vae.pt # check squeeze/unsqueeze
    # from finch_window_mwe and paper
    params:
      num_freq_bins: 128
      num_time_bins: 128
      min_freq: 400
      max_freq: 10000
      win_len: 0.12 # 120 ms segments of audio
      nperseg: 512
      noverlap: 256
      max_dur: 1000000000.0
      spec_min_val: 2.0 # minimum STFT log-modulus
      spec_max_val: 6.5 # maximum STFT log-modulus
      mel: True # spaced between 0.4 - 10 kHz, check implementation
      within_syll_normalize: False
      time_stretch: False
      # fps: 30
      # shoulder: 0.01
      # shoulder_spec: True
      save_spec: True
      save_latent: True
    gpu: True
    gpu_num: 0
    spec_latent_movie: False
    time_opt: True
    timing:
      - proc_timestamps
      - get_wav_out
      - get_spec
      - spec_to_store
      - to_device
      - inference_time
      - z_to_np
      - z_to_store
      - put_q_out
      - proc_total_times
    out_path: output_105clip_120ms_sl
    method: fork
  
  # Analysis:
  #   package: actors.analysis
  #   class: VAEAnalysis

  # Visual:
  #   package: actors.visual
  #   class: AVAVisual
  #   out_oath: output/plots

connections:
  Acquirer.q_out: [Processor.q_in]
  # Acquirer.q_out: [Processor.q_in, Visual.q_audio]
  # Processor.q_out: [Visual.q_in]
  # Processor.q_out: [Analysis.q_in]
  # Analysis.q_out: [Visual.q_in]